import board
import busio
import time
from adafruit_hid.mouse import Mouse
from adafruit_hid.mouse import MouseEvent
from adafruit_hid.device import Device
import digitalio

# Set up serial connection
uart = busio.UART(board.TX, board.RX, baudrate=115200)

# Create a Mouse object
mouse = Mouse()

def move_mouse_to_coordinates(coord):
    # Move mouse to the given coordinates
    x, y = coord
    mouse.move(x=x, y=y)

def click_mouse():
    # Click the left mouse button
    mouse.click(MouseEvent.LEFT_BUTTON)

while True:
    if uart.in_waiting:  # Check if data is available to read
        data = uart.readline()  # Read a line of data
        coords = data.decode('utf-8').strip()  # Decode and strip newline characters
        
        if coords:  # Check if coordinates were received
            x, y = map(int, coords.split(','))  # Split and convert to integers
            print(f"Moving mouse to: ({x}, {y})")
            move_mouse_to_coordinates((x, y))  # Move the mouse to the coordinates
            click_mouse()  # Simulate a left mouse click
            time.sleep(0.1)  # Small delay to avoid flooding
        else:
            print("rpi did not receive any coordinates")

